---
title: "Blog Post 4"
subtitle: "Phase 2 of the EDA"
description:  |
  Data Link:
  https://www.kaggle.com/datasets/konradb/prison-population-in-the-us?select=populations_states.csv
author: "Group 10"
date: "2024-11-1"
categories: [Blog Post 4]
date-modified: "2024-11-1"
draft: FALSE
---

```{r}
library(dplyr)
library(ggplot2)

data <- readRDS("dataset/cleaned_dataset.rds")

data_filtered <- data |>
  filter(Date >= as.Date("2019-01-01") & Date <= as.Date("2022-12-31"))

data_filtered <- data_filtered |>
  group_by(State) |>
  mutate(
    White_Admission_Rate = White_Admissions / Total_Admissions,
    Black_Admission_Rate = Black_Admissions / Total_Admissions,
    Hispanic_Admission_Rate = Hispanic_Admissions / Total_Admissions,
    AmericanIndian_Admission_Rate = AmericanIndian_Admissions / Total_Admissions,
    Asian_Admission_Rate = Asian_Admissions / Total_Admissions,
    Other_Admission_Rate = Other_Admissions / Total_Admissions,
    White_Release_Rate = White_Releases / Total_Releases,
    Black_Release_Rate = Black_Releases / Total_Releases,
    Hispanic_Release_Rate = Hispanic_Releases / Total_Releases,
    AmericanIndian_Release_Rate = AmericanIndian_Releases / Total_Releases,
    Asian_Release_Rate = Asian_Releases / Total_Releases,
    Other_Release_Rate = Other_Releases / Total_Releases
  )

ggplot(data_filtered, aes(x = State, y = White_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "White Admission Rate by State", y = "White Admission Rate")

ggplot(data_filtered, aes(x = State, y = Black_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "Black Admission Rate by State", y = "Black Admission Rate")

ggplot(data_filtered, aes(x = State, y = Hispanic_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "Hispanic Admission Rate by State", y = "Hispanic Admission Rate")

ggplot(data_filtered, aes(x = State, y = AmericanIndian_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "American Indian Admission Rate by State", y = "American Indian Admission Rate")

ggplot(data_filtered, aes(x = State, y = Asian_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "Asian Admission Rate by State", y = "Asian Admission Rate")

ggplot(data_filtered, aes(x = State, y = Other_Admission_Rate)) +
  geom_boxplot() +
  labs(title = "Other Admission Rate by State", y = "Other Admission Rate")

ggplot(data_filtered, aes(x = State, y = White_Release_Rate)) +
  geom_boxplot() +
  labs(title = "White Release Rate by State", y = "White Release Rate")

ggplot(data_filtered, aes(x = State, y = Black_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Black Release Rate by State", y = "Black Release Rate")

ggplot(data_filtered, aes(x = State, y = Hispanic_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Hispanic Release Rate by State", y = "Hispanic Release Rate")

ggplot(data_filtered, aes(x = State, y = AmericanIndian_Release_Rate)) +
  geom_boxplot() +
  labs(title = "American Indian Release Rate by State", y = "American Indian Release Rate")

ggplot(data_filtered, aes(x = State, y = Asian_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Asian Release Rate by State", y = "Asian Release Rate")

ggplot(data_filtered, aes(x = State, y = Other_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Other Release Rate by State", y = "Other Release Rate")

racial_summary <- data_filtered |>
  summarise(
    Mean_White_Admission_Rate = mean(White_Admission_Rate, na.rm = TRUE),
    Median_White_Admission_Rate = median(White_Admission_Rate, na.rm = TRUE),
    Mean_Black_Admission_Rate = mean(Black_Admission_Rate, na.rm = TRUE),
    Median_Black_Admission_Rate = median(Black_Admission_Rate, na.rm = TRUE),
    Mean_Hispanic_Admission_Rate = mean(Hispanic_Admission_Rate, na.rm = TRUE),
    Median_Hispanic_Admission_Rate = median(Hispanic_Admission_Rate, na.rm = TRUE),
    Mean_AmericanIndian_Admission_Rate = mean(AmericanIndian_Admission_Rate, na.rm = TRUE),
    Median_AmericanIndian_Admission_Rate = median(AmericanIndian_Admission_Rate, na.rm = TRUE),
    Mean_Asian_Admission_Rate = mean(Asian_Admission_Rate, na.rm = TRUE),
    Median_Asian_Admission_Rate = median(Asian_Admission_Rate, na.rm = TRUE),
    Mean_Other_Admission_Rate = mean(Other_Admission_Rate, na.rm = TRUE),
    Median_Other_Admission_Rate = median(Other_Admission_Rate, na.rm = TRUE),
    Mean_White_Release_Rate = mean(White_Release_Rate, na.rm = TRUE),
    Median_White_Release_Rate = median(White_Release_Rate, na.rm = TRUE),
    Mean_Black_Release_Rate = mean(Black_Release_Rate, na.rm = TRUE),
    Median_Black_Release_Rate = median(Black_Release_Rate, na.rm = TRUE),
    Mean_Hispanic_Release_Rate = mean(Hispanic_Release_Rate, na.rm = TRUE),
    Median_Hispanic_Release_Rate = median(Hispanic_Release_Rate, na.rm = TRUE),
    Mean_AmericanIndian_Release_Rate = mean(AmericanIndian_Release_Rate, na.rm = TRUE),
    Median_AmericanIndian_Release_Rate = median(AmericanIndian_Release_Rate, na.rm = TRUE),
    Mean_Asian_Release_Rate = mean(Asian_Release_Rate, na.rm = TRUE),
    Median_Asian_Release_Rate = median(Asian_Release_Rate, na.rm = TRUE),
    Mean_Other_Release_Rate = mean(Other_Release_Rate, na.rm = TRUE),
    Median_Other_Release_Rate = median(Other_Release_Rate, na.rm = TRUE)
  )
```
```{r}
ggplot(data_filtered, aes(x = State, y = White_Admission_Rate - White_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for White by State", y = "Admission - Release Rate Difference (White)")

ggplot(data_filtered, aes(x = State, y = Black_Admission_Rate - Black_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for Black by State", y = "Admission - Release Rate Difference (Black)")

ggplot(data_filtered, aes(x = State, y = Hispanic_Admission_Rate - Hispanic_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for Hispanic by State", y = "Admission - Release Rate Difference (Hispanic)")

ggplot(data_filtered, aes(x = State, y = AmericanIndian_Admission_Rate - AmericanIndian_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for American Indian by State", y = "Admission - Release Rate Difference (American Indian)")

ggplot(data_filtered, aes(x = State, y = Asian_Admission_Rate - Asian_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for Asian by State", y = "Admission - Release Rate Difference (Asian)")

ggplot(data_filtered, aes(x = State, y = Other_Admission_Rate - Other_Release_Rate)) +
  geom_boxplot() +
  labs(title = "Difference between Admission and Release Rates for Other by State", y = "Admission - Release Rate Difference (Other)")
```
```{r}
library(lme4)

data_filtered$State <- as.factor(data_filtered$State)

model_admissions <- lmer(Total_Admissions ~ White_Admissions + Black_Admissions + Hispanic_Admissions + AmericanIndian_Admissions + Asian_Admissions + Other_Admissions + (1 | State), data = data_filtered)

summary(model_admissions)
```



